<odoo>


	<!-- CUSTOM WAREHOUSE FORM VIEW -->
	<record id="search_view_move_order" model="ir.ui.view">
		<field name="name">move.order.search.view</field>
		<field name="model">move.order</field>
		<field name="arch" type="xml">
			<search string="Move Order">
				<field name="name" string="Reference"/>
				<field name="user_id" string="Responsible"/>
				<filter string="Today" name="mo_today" domain="[('date', '=', context_today().strftime('%Y-%m-%d'))]"/>
				<group expand="0" string="Group By">
					<filter string="State" name="state" domain="[]" context="{'group_by':'state'}"/>
					<filter string="Type" name="move_type_id" domain="[]" context="{'group_by':'move_type_id'}"/>
					<filter string="Responsible" name="user_id" domain="[]" context="{'group_by':'user_id'}"/>
					<filter string="Warehouse" name="warehouse_id" domain="[]" context="{'group_by':'warehouse_id'}"/>
					<filter string="Date" name="date" domain="[]" context="{'group_by':'date'}"/>
				</group>
			</search>
		</field>
	</record>

	<record id="search_view_move_order_external" model="ir.ui.view">
		<field name="name">move.order.external.search.view</field>
		<field name="model">move.order</field>
		<field name="arch" type="xml">
			<search string="Move Order">
				<field name="name" string="Reference"/>
				<field name="user_id" string="Responsible"/>
				<group expand="0" string="Group By">
					<filter string="State" name="state" domain="[]" context="{'group_by':'state'}"/>
					<filter string="Responsible" name="user_id" domain="[]" context="{'group_by':'user_id'}"/>
					<filter string="Warehouse" name="warehouse_id" domain="[]" context="{'group_by':'warehouse_id'}"/>
					<filter string="Customer" name="partner_id" domain="[]" context="{'group_by':'partner_id'}"/>
					<filter string="Date" name="date" domain="[]" context="{'group_by':'date'}"/>
				</group>
			</search>
		</field>
	</record>

	<record id="view_warehouse_form_kitchen" model="ir.ui.view">
		<field name="name">stock.warehouse.form.kitchen</field>
		<field name="model">stock.warehouse</field>
		<field name="inherit_id" ref="stock.view_warehouse"/>
		<field name="arch" type="xml">
			<field name="wh_output_stock_loc_id" position="after">
				<field name="loc_kitchen_id"/>
			</field>
			<xpath expr="//form/sheet" position="before">
				<header>
					<button name="update_warehouse_location" type="object" string="Update WH Location" class="oe_highlight"/>
				</header>
			</xpath>
		</field>
	</record>


	<!-- MOVE ORDER -->
	<record id="move_order_tree_view" model="ir.ui.view">
		<field name="name">move.order.tree</field>
		<field name="model">move.order</field>
		<field name="arch" type="xml">
			<tree decoration-info="state == 'draft'" decoration-danger="state == 'confirm'" decoration-muted="state == 'cancel'" string="Move Order">
				<field name="name"/>
				<field name="warehouse_id" />
				<field name="date"/>
				<field name="user_id"/>
				<!-- <field name="move_type_id"/> -->
				<field name="move_order_type"/>
				<field name="loc_src_id"/>
				<field name="loc_dest_id"/>
				<field name="state"/>
			</tree>
		</field>
	</record>

	<record id="move_order_form_view" model="ir.ui.view">
		<field name="name">move.order.form</field>
		<field name="model">move.order</field>
		<field name="arch" type="xml">
			<form string="Move Order">
				<header>
					<button name="action_update_onhand_line" type="object" states="draft" class="oe_highlight" string="Update Onhand Qty"/>
					<button name="move_open" type="object" states="draft" string="Confirm" class="oe_highlight" groups="aa_move_order.group_move_order_confirm,aa_move_order.group_move_order_fg_confirm"/>
					<button name="move_done" type="object" states="confirm" string="Approve" class="oe_highlight" groups="aa_move_order.group_move_order_done,aa_move_order.group_move_order_fg_done"/>
					<button name="move_draft" type="object" states="confirm" string="Set to Draft"/>
					<field name="state" widget="statusbar" statusbar_visible="draft,confirm,done"/>
				</header>
				<sheet>
					<div class="oe_button_box" name="button_box">
						<button name="action_view_picking" type="object" class="oe_stat_button" icon="fa-truck" attrs="{'invisible': [('picking_count', '=', 0)]}">
							<field name="picking_count" widget="statinfo" string="Transfer"/>
						</button>
					</div>
					<div class="oe_title">
						<h1>
							<field name="name"/>
						</h1>
					</div>
					<group>
						<group>
							<field name="partner_id" options="{'no_create': True, 'no_open': True}" attrs="{'readonly' : [('state', '!=', 'draft')]}"/>
							<field name="date"/>
							<!-- <field name="move_type_id" options="{'no_create': True, 'no_open': True}"/> -->
							<field name="move_order_type"/>
							<field name="physical_inventory_type" attrs="{'invisible' : [('move_order_type', '!=', 'physical_inventory')]}"/>
							<!-- <field name="loc_src_id" readonly="1" force_save="1" options="{'no_create': True, 'no_open': True}"/> -->
							<field name="loc_src_id"/>
						</group>
						<group>
							<field name="user_id" options="{'no_create': True, 'no_open': True}"/>
							<field name="warehouse_id" force_save="1" options="{'no_create': True, 'no_open': True}"/>
							<field name="description"/>
							<field name="account_id" options="{'no_create': True, 'no_open': True}" attrs="{'invisible' : [('move_order_type', '!=', 'internal_use')]}"/>
							<!-- <field name="loc_dest_id" readonly="1" force_save="1" options="{'no_create': True, 'no_open': True}"/> -->
							<field name="loc_dest_id"/>
						</group>
					</group>
					<notebook>
						<page string="Components Lines">
							<field name="move_line" nolabel="1" widget="one2many_list">
								<tree editable="bottom">
									<field name="product_id" options="{'no_create' : True, 'no_edit' : True, 'no_open' : True}" domain="[('stock_quant_ids.location_id','=',parent.loc_src_id)]"/>
									<!-- <field name="categ_id"/> -->
									<field name="product_uom" readonly="1" force_save="1" />
									<field name="inventory_uom" readonly="1" force_save="1"/>
									<field name="onhand_qty"/>
									<!-- <field name="dest_onhand_qty"/> -->
									<field name="product_qty"/>
									<field name="qty_diff" attrs="{'column_invisible' : [('parent.move_order_type', '!=', 'physical_inventory')]}"/>
									<field name="locator"/>
								</tree>
							</field>
						</page>
					</notebook>
					<field name="note" placeholder="Note..." attrs="{'readonly': [('state', '!=', 'draft')]}"/>
				</sheet>
				<div class="oe_chatter">
					<field name="message_follower_ids" widget="mail_followers"/>
					<field name="message_ids" widget="mail_thread"/>
				</div>
			</form>
		</field>
	</record>

	<record model="ir.actions.act_window" id="move_order_action">
		<field name="name">Move Order</field>
		<field name="res_model">move.order</field>
		<field name="view_mode">tree,form</field>
		<field name="search_view_id" ref="search_view_move_order"/>
	</record>

	<record id="action_mass_confirm" model="ir.actions.server">
		<field name="name">Mass Confirm</field>
		<field name="type">ir.actions.server</field>
		<field name="state">code</field>
		<field name="model_id" ref="aa_move_order.model_move_order"/>
		<field name="binding_model_id" ref="aa_move_order.model_move_order"/>
		<field name="code">
record_not_draft =  records.filtered(lambda x : x.state != 'draft')
if record_not_draft:
	raise Warning("You can only mass confirm in state draft !")
else:
	for item in records:
		item.move_open()
		</field>
	</record>

	<record id="action_mass_approve" model="ir.actions.server">
		<field name="name">Mass Approve</field>
		<field name="type">ir.actions.server</field>
		<field name="state">code</field>
		<field name="model_id" ref="aa_move_order.model_move_order"/>
		<field name="binding_model_id" ref="aa_move_order.model_move_order"/>
		<field name="code">
record_not_draft =  records.filtered(lambda x : x.state != 'confirm')
if record_not_draft:
	raise Warning("You can only mass confirm in state draft !")
else:
	for item in records:
		item.move_done()
		</field>
	</record>

	<menuitem id="menu_move_order" name="Move Order" parent="stock.menu_stock_warehouse_mgmt" action="move_order_action" sequence="1"/>
	<menuitem id="menu_move_order_mrp" name="Move Order" parent="mrp.menu_mrp_manufacturing" action="move_order_action" sequence="4"/>

	<!-- MOVE TYPE -->
	<record id="move_type_tree_view" model="ir.ui.view">
		<field name="name">move.type.tree</field>
		<field name="model">move.type</field>
		<field name="arch" type="xml">
			<tree string="Move Type">
				<field name="name"/>
				<field name="warehouse_id"/>
				<field name="loc_src_id"/>
				<field name="loc_dest_id"/>
			</tree>
		</field>
	</record>

	<record id="move_type_form_view" model="ir.ui.view">
		<field name="name">move.type.form</field>
		<field name="model">move.type</field>
		<field name="arch" type="xml">
			<form string="Move Type">
				<sheet>
					<group>
						<field name="name"/>
						<field name="warehouse_id" options="{'no_create': True, 'no_open': True}"/>
						<field name="loc_src_id" options="{'no_create': True, 'no_open': True}"/>
						<field name="loc_dest_id" options="{'no_create': True, 'no_open': True}"/>
					</group>
				</sheet>
			</form>
		</field>
	</record>

	<record model="ir.actions.act_window" id="move_type_action">
		<field name="name">Move Type</field>
		<field name="res_model">move.type</field>
		<field name="view_mode">tree,form</field>
	</record>

	<menuitem id="menu_move_type" name="Move Type" parent="stock.menu_warehouse_config" action="move_type_action"/>
</odoo>
